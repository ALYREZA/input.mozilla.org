{% extends "search_base.html" %}

{% block body_id %}search{% endblock %}

{% block content %}
<h1><a href="{{ url('dashboard') }}">Firefox Input</a> &ndash; Search Results</h1>


<div id="search_box" class="clearfix">
  <div id="search_options">
    {% if query %}
    Description: <span class="opt">"{{ query }}"</span>;
    Dates: <span class="opt">{{ form.cleaned_data.date_start }}
      &ndash; {{ form.cleaned_data.date_end }}</span>
    <br/>
    Locale: <span class="opt">{{ form.cleaned_data.locale|default("all", true) }}</span>;
    OS: <span class="opt">{{ form.cleaned_data.os|default("all", true) }}</span>
    {% endif %}
  </div>

  {% with search_form = form %}{% include "search/search_form.html" %}{% endwith %}
</div>

<div id="results" class="container">
  <ul>
    {% if page.object_list %}
      {% for result in page.object_list %}
      <li>
        {{ smiley(result.object.positive and "happy" or "sad") }}
        {{ result.object.description }}
      </li>
      {% endfor %}
    {% else %}
    <li>No search results found.</li>
    {% endif %}
  </ul>
</div>

<div id="overview">
  <div id="sentiment" class="container clearfix">
    <h2>User Sentiment</h2>
    <div>
      <div class="emotion {{ sent.sentiment }}">{{ smiley(sent.sentiment) }}</div>
      {% with bar_width = 75 %}
        <div class="response total" style="width: {{ bar_width }}%">{{ sent.total }} total responses</div>
        {% if sent.total > 0 %}
        <div class="response happy" style="width: {{
          sent.happy / sent.total * bar_width }}%" >{{
          sent.happy }} happy</div>
        <div class="response sad" style="width: {{
          sent.sad / sent.total * bar_width }}%">{{
          sent.sad }} sad</div>
        {% endif %}
      {% endwith %}
    </div>
  </div>

  <div id="trends" class="container clearfix">
    <h2>Trends</h2>
    <div class="terms">
      {% with prod = form.cleaned_data.product %}
        {% include "dashboard/trends.html" %}
      {% endwith %}
    </div>
  </div>

  <div id="demo" class="container clearfix">
    <h2>Demographics</h2>
    <div class="ajaxy"></div>
    <div class="prototype">
      {% include "dashboard/demographics.html" %}
    </div>
  </div>
</div>
{% endblock %}
